---
- name: Geo blocking
  hosts: all
  connection: local
  gather_facts: false
  vars:
    ansible_host: ''
    api_id: ''
    api_key: ''
    site_id: ''
    rule_id: ''
    # Countries are currently hardcoded


  tasks:
    - name: Blocking now...
      uri:
        url: "https://{{ansible_host}}/api/prov/v1/sites/customCertificate/upload"
        body_format: json
        body: '{"countries" : "CA,US", "rule_id" : "api.acl.blacklisted_countries"}'
        follow_redirects: none
        method: POST
      register: _result